# 4, 5장

1. 스트림 소개
    1. 스트림이란
        - 데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소
        - 자바 8 API 기능에 추가된 기능으로 데이터를 처리하는 역할
        
    2. 스트림의 특징
        - 연속된 요소 : 컬렉션과 다르게 스트림은 표현 계산식이 주를 이룬다.
        - 소스 : 스트림은 데이터 제공 소스로부터 데이터를 소비한다.(외부 데이터를 따라간다)
        - 데이터 처리 연산 : 스트림 연산은 순차적 또는 병렬적으로 실행할 수 있다.
        - 파이프라이닝 : 스트림 연산은 대부분 스트림을 반환하기 때문에 파이프라인을 자유롭게 만들 수 있다. 또한 파이프라인은 질의 같은 존재이다.
        - 내부 반복 : 반복자 없이 쉽고 편리하게 반복 가능하다.
        
    3. 스트림의 큰 특징
        - 스트림은 직관적이다 : 간결하고 가독성이 좋다.
        - 스트림은 유연하다 : 파이프라인을 형성할 수 있다.
        - 스트림은 우월하다 : 병렬화 작업으로 성능이 좋다.
        
    4. 스트림과 컬렉션의 차이
        - 데이터를 언제 계산하느냐가 가장 큰 차이다.
        - 컬렉션은 모든 데이터를 메모리에 저장하는 자료구조다. 즉 모든 요소가 컬렉션에 추가되기 전에 계산되어야 한다. (컬렉션에서 추가, 삭제 시 모든 요소를 메모리에 저장 및 미리 계산되어있어야 한다) 반면, 스트림은 요청할 때만 요소를 계산하는 자료구조다.
        - 스트림은 단 한번만 탐색할 수 있다.
        - 스트림은 내부 반복을 사용한다. 내부 반복은 다음과 같은 이점을 가진다.
            - 사용자가 직관적으로 반복을 사용할 수 있다.
            - 작업을 투명하게 병렬로 처리할 수 있다.
            - 더 최적화된 다양한 순서로 처리할 수 있다.
            
    5. 스트림 연산
        - 스트림 연산은 중간 연산과 최종 연산으로 나누어진다.
        - 중간 연산
            - 결과로 다른 스트림을 반환하여 파이프라인을 형성할 수 있다.
            - 단말 연산을 파이프라인에 실행하기 전까진 아무 연산도 수행하지 않는다(게으르다) → 파이프라인이 실행될 경우 연결된 모든 연산이 한번에 실행된다. → 제한에 따라 연산을 일부만 하는 등 이점을 얻을 수 있다(쇼트 서킷)
        - 최종 연산
            - 파이프라인의 결과를 도출하는 연산이다.
        - 스트림 이용 과정은 결국 다음과 같다.
            
            1) 질의를 수행할 데이터 소스
            
            2) 파이프라인을 구성할 중간 연산 연결
            
            3) 결과를 도출할 최종 연산 연결
            
2. 스트림 활용
    1. 필터링
        - Filter 메서드를 지원하며 filter(boolean return) 형식으로 사용한다.
        - Filter 메서드는 프리티케이트를 인수로 받아서 일치하는 모든 스트림을 반환한다.
        - 스트림에 조건을 건다고 생각하면 된다.
        - ex) .filter(Dish::isVegetarian)
        - distinct() 메서드는 스트림의 중복을 제거해준다.
        
    2. 스트림 슬라이싱
        - 프리디케이트를 이용한 슬라이싱 (자바 9 이후)
            - 거대한 스트림을 필터링 할 때 유용하다.
            - takeWhile(boolean return) : 조건에 맞지 않은 스트림이 나올 경우 탐색을 멈추고 앞부분을 슬라이싱한다.
            - dropWhile(boolean return) : 조건에 맞지 않은 스트림이 나올 경우 탐색을 멈추고 뒷부분을 슬라이싱한다.
        - 스트림 축소
            - limit 메서드를 지원하며 limit(int) 형식으로 사용된다.
            - 스트림의 갯수를 제한해주는 역할을 한다.
        - 요소 건너뛰기
            - skip 메서드를 지원하며 skip(int) 형식으로 사용된다.
            - 스트림의 요소를 일부 건너뛰는 역할을 한다.
            
    3. 매핑
        - 정의
            - 스트림 내부 요소를 변환하거나 추출하는 용도로 사용된다. 람다를 이용한다.
        - 스트림 평면화
            - 스트림의 요소를 환경에 구애받지 않고 평면으로 만들어 사용할 수 있다.
            - flatMap 메서드를 지원하며 flatMap(lambda) 형식으로 사용한다.
            - flatMap은 여러 스트림 리스트를 컨텐츠 중심으로 매핑해주는 역할을 한다.
            - ex) 문자열 리스트를 문자로 파싱해서 중복을 제거할 경우
                - map을 이용할 경우
                    ![Untitled (5)](https://user-images.githubusercontent.com/57245883/196022517-6b78ef7c-14f2-42ab-81c2-5b0e6ee77eae.png)
                - flatMap을 이용할 경우
                    ![Untitled (6)](https://user-images.githubusercontent.com/57245883/196022550-30679bb1-905b-45b0-92d0-d5a0610b07ff.png)

                
    4. 검색과 매칭
        - allMatch : boolean allMatch(boolean) 형식으로 사용하며 스트림의 모든 요소가 프리디케이트와 일치하는지 검사한다. 쇼트서킷 기법을 이용한다.
        - anyMatch : boolean anyMatch(boolean) 형식으로 사용하며 스트림의 적어도 한 요소가 프리디케이트와 일치하는지 검사한다. 쇼트서킷 기법을 이용한다.
        - noneMatch : boolean noneMatch(boolean) 형식으로 사용하며 allMatch와 반대 연산이다. 쇼트서킷 기법을 이용한다.
        - findFirst : findFirst() 형식으로 사용하며, 현재 스트림에서 조건에 맞는 첫번째 요소를 반환한다. 스트림의 맨 앞 요소를 반환한다.
        - findAny : findAny() 형식으로 사용하며, 현재 스트림에서 조건에 맞는 임의의 요소를 반환한다. 멀티스레드에서 가장 먼저 연산된 요소를 반환한다.
        - Optional : Null 처리를 위해 설계된 컨테이너 클래스. null 값을 확인하고 처리를 강제하는 기능을 제공한다.
        
    5. 리듀싱
        - 모든 스트림 요소를 처리해서 값으로 도출하는 연산. 최종 연산이다.
        - reduce 메소드를 이용하며, reduce 내부 인자로 (초깃값, 요소를 조합하는 연산)을 갖는다. ex) reduce(0, (a, b)→ a + b)
        - 초깃값이 없을 경우 Optional 객체를 반환한다.
        - sum, max, min을 쉽게 사용할 수 있다. ex) reduce(0, Integer::sum)
        - 리듀싱 연산은 병렬 연산이 가능하다는 장점이 있다. 하지만 조건이 맞아야 한다.
            
            
    6. 기본형 특화 스트림 (숫자 스트림을 다루는 방법)
        - 박싱 비용을 피하기 위해 만들어졌으며, 숫자형 스트림을 효율적으로 다룰 수 있는 새로운 스트림 형식이다.
        - 기존에는 스트림의 요소의 총합을 구하기 위해 map().reduce(0, Integer::sum)을 이용했다. 하지만 sum 함수에서 Integer→ int로 언박싱 해야 하기 때문에 박싱 비용이 든다.
        - map().sum() 형식은 어떨까? 여기서 map이 반환하는 스트림은 자료형을 확립할 수 없기 때문에 sum이 작동하지 않는다.(스트림의 자료형이 클래스일수도 있기 때문이다)
        - 기본형 특화 스트림은 기존 스트림을 IntStream(etc..)이라는 특수한 스트림으로 반환하여 박싱 비용을 피하고 예외를 피해주며, 다양한 연산 유틸리티 메서드(sum, min, max)를 지원한다.
        - map 메서드와 과 같은 형식으로 사용하며, mapToInt(), mapToDouble(), mapToLong() 등이 존재한다.
        - 일반 스트림으로 복원하고 싶을 땐 (특화스트림).boxed()를 이용한다.
        - 특화 스트림에서 max, min, sum을 사용할 경우 초기값 설정을 못해주기 때문에 오류가 날 수 있다. → OptionalInt 를 사용하여 예외를 처리해준다.
        - range, rangeClosed 메서드 : 일정 숫자 범위의 특화 스트림을 만들 수 있다.
        
    7. 스트림 만들기
        - 값으로 스트림 만들기
        - null 객체로 스트림 만들기
        - 배열로 스트림 만들기
        - 파일로 스트림 만들기
        - 함수로 무한 스트림 만들기
